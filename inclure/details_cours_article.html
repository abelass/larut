#SET{date,#ARRAY}
#SET{horaire,#ARRAY}
#SET{prix,#ARRAY}
#SET{lieu,#ARRAY}
#SET{id_prix_objet,#ARRAY}
#SET{id_gis,#ARRAY}
#SET{prix_evenement,#ARRAY}
#SET{id_evenement,#ARRAY}
<BOUCLE_rub_res(RUBRIQUES){lang}{composition=reservation}{0,1}{tout}>
    #SET{url_reservation,#URL_RUBRIQUE}
</BOUCLE_rub_res>
    <BOUCLE_rub_res_def(RUBRIQUES){composition=reservation}{0,1}{tout}>
        #SET{url_reservation,#URL_RUBRIQUE}
    </BOUCLE_rub_res_def>
<//B_rub_res>
#SET{multi,''}
<BOUCLE_evenement(EVENEMENTS){id_article}{inscription=1}{date_fin>#DATE}{par date_debut}>
    [(#ID_EVENEMENT_SOURCE|=={0}|?{
       #SET{id_evenement,#GET{id_evenement}|push{#ID_EVENEMENT}}   
        #SET{dates_#ID_EVENEMENT,#ARRAY{#COMPTEUR_BOUCLE,#ARRAY{
            date_debut,#DATE_DEBUT,
            date_fin,#DATE_FIN,
            id_source,#ID_EVENEMENT_SOURCE}}},
        [(#GET{dates_#ID_EVENEMENT_SOURCE}|is_array|?{
            #SET{dates_#ID_EVENEMENT_SOURCE,#GET{dates_#ID_EVENEMENT_SOURCE}|array_merge{#ARRAY{
                #COMPTEUR_BOUCLE,#ARRAY{
                    date_debut,#DATE_DEBUT,
                    date_fin,#DATE_FIN,
                    id_source,#ID_EVENEMENT_SOURCE}}}},
            #SET{dates_#ID_EVENEMENT_SOURCE,#ARRAY{#COMPTEUR_BOUCLE,
                #ARRAY{
                    date_debut,#DATE_DEBUT,
                    date_fin,#DATE_FIN,
                    id_source,#ID_EVENEMENT_SOURCE}}}
            #SET{id_evenement,#GET{id_evenement}|push{#ID_EVENEMENT_SOURCE}}  
        })]    
    })]     
    
                       
    #SET{h,#DATE_DEBUT|affdate{H:i}|concat{-#DATE_FIN|affdate{H:i}}}
    [(#GET{h}|in_array{#GET{horaire}}|non)#SET{horaire,#GET{horaire}|array_merge{#ARRAY{#COMPTEUR_BOUCLE,#DATE_DEBUT|affdate{H:i}|concat{-#DATE_FIN|affdate{H:i}}}}}]
    #SET{prix_evenement,#ARRAY}
    
    <BOUCLE_prix(PRIX_OBJETS){id_objet=#ID_EVENEMENT}{objet=evenement}{id_prix_objet !IN #GET{id_prix_objet}}{si #ID_EVENEMENT_SOURCE|=={0}|oui}>
        #SET{id_prix_objet,#GET{id_prix_objet}|array_merge{#ARRAY{#COMPTEUR_BOUCLE,#ID_PRIX_OBJET}}}
        #SET{prix_evenement,#GET{prix_evenement}|array_merge{#ARRAY{#COMPTEUR_BOUCLE,#ARRAY{prix,#PRIX,id_declinaison,#ID_DECLINAISON}}}}
    </BOUCLE_prix>
    #SET{prix,#GET{prix}|array_merge{#ARRAY{#COMPTEUR_BOUCLE,#GET{prix_evenement}}}} 
    </B_prix> 
    
    <BOUCLE_lieu(GIS){id_evenement}{id_gis !IN #GET{id_gis}}{0,1}>
        #SET{id_gis,#GET{id_gis}|array_merge{#ARRAY{#COMPTEUR_BOUCLE,#ID_GIS}}}    
        #SET{lieu,#GET{lieu}|array_merge{#ARRAY{
            #COMPTEUR_BOUCLE,#ARRAY{
                    titre,#TITRE,
                    adresse,#ADRESSE**,
                    code_postal,#CODE_POSTAL,
                    ville,#VILLE
                    }
                  }
               }
           }       
    </BOUCLE_lieu>
</BOUCLE_evenement>

<BOUCLE_prix_art(PRIX_OBJETS){id_objet=#ID_ARTICLE}{objet=article}{si #GET{prix}|count|<{1}|oui}>
        [(#ID_PRIX_OBJET|in_array{#GET{id_prix_objet}}|non)
        #SET{prix_evenement,#GET{prix_evenement}|array_merge{#ARRAY{#COMPTEUR_BOUCLE,#ARRAY{prix,#PRIX,id_declinaison,#ID_DECLINAISON}}}}
         ]
         #SET{id_prix_objet,#GET{id_prix_objet}|array_merge{#ARRAY{#COMPTEUR_BOUCLE,#ID_PRIX_OBJET}}}
</BOUCLE_prix_art>
    #SET{prix,#GET{prix_evenement}} 
 </B_prix_art>
    
<BOUCLE_lieu_art(GIS){id_article}{si #GET{lieu}|count|<{1}} {0,1}>
    #SET{id_gis,#GET{id_gis}|array_merge{#ARRAY{#COMPTEUR_BOUCLE,#ID_GIS}}}   
    #SET{lieu,#GET{lieu}|array_merge{#ARRAY{
        #COMPTEUR_BOUCLE,#ARRAY{
                titre,#TITRE,
                adresse,#ADRESSE**,
                code_postal,#CODE_POSTAL,
                ville,#VILLE
                }
              }
           }
       }        
</BOUCLE_lieu_art>
<div class="infos_cours">

<B_date_resultat>

<BOUCLE_date_resultat(DATA){source tableau,#GET{id_evenement}}>
#SET{compteur,#COMPTEUR_BOUCLE}   
#SET{cacher,''}
#SET{id_evenement,#VALEUR}               
            <B_evs_enfant>
                [(#TOTAL_BOUCLE|>{3}|oui)
                #SET{cacher,'invisible'}
                ]
                    <table> 
                        <tbody> 
                        <tr>
                            <td class="label"><:reservation:label_date:></td>
                            <td>
                                <ul[(#GET{cacher}|oui) class="inline"]>  
                                             
                                 <BOUCLE_evs_enfant(DATA){source tableau,#GET{dates_#VALEUR}}{si #GET{dates_#VALEUR}|count|>{1}|oui}>
									[(#ID_SOURCE|=={0}|oui)#SET{evenements,#GET{id_evenement}}]
									#SET{separateur,''}
                                    [(#TOTAL_BOUCLE|>{3}|oui)                                    
                                    #SET{cacher,'invisible'}
                                    [(#COMPTEUR_BOUCLE|=={1}|oui)#SET{cacher,''}]
                                     [(#COMPTEUR_BOUCLE|=={#TOTAL_BOUCLE}|oui)#SET{cacher,''}#SET{separateur,'-'}]  
                                    ]
                                 
                                     <li class="date[ (#GET{cacher})]">#GET{separateur}[(#DATE_DEBUT|affdate_jourcourt)][(#GET{separateur}|oui) <span class="total_cours">([(#TOTAL_BOUCLE)] <:larut:cours:>)</span>]</li>      
                                 </BOUCLE_evs_enfant>            
                                </ul>   
                            </td>
                        </tr> 
                        <INCLURE{fond=inclure/details_cours_article_horaire,horaire=#GET{horaire}}/>
                        <INCLURE{fond=inclure/details_cours_article_prix,prix=#GET{prix}}/>
                        <INCLURE{fond=inclure/details_cours_article_lieu,lieu=#GET{lieu}}/>
                        </tbody>                                                       
                    </table>
                    <a class="btn btn-primary" href="[(#GET{url_reservation}|parametre_url{id_evenement,#GET{evenements}})]"><i class="icon-arrow-right icon-white"></i> <:larut:inscription:></a>                                       
               </B_evs_enfant>
               <div class="infos_cours">
                <table> 
                    <tbody> 
                    <tr>
                        <td class="label"><:reservation:label_date:></td>
                        <td>
                            <ul>               
                               <BOUCLE_evs_enfant_alt(DATA){source tableau,#GET{dates_#VALEUR}}>
                                [<div class="entete">(#DATE_DEBUT|affdate_debut_fin{#DATE_FIN,non})</div>]
                               </BOUCLE_evs_enfant_alt>
                                    </ul>   
                        </td>
                    </tr>                         
                    <INCLURE{fond=inclure/details_cours_article_horaire,horaire=#GET{horaire}}/>
                    <INCLURE{fond=inclure/details_cours_article_prix,prix=#GET{prix}}/>
                    <INCLURE{fond=inclure/details_cours_article_lieu,lieu=#GET{lieu}}/>
                   </tbody>                                             
                </table> 
               <a class="btn btn-primary" href="[(#GET{url_reservation}|parametre_url{id_evenement,#GET{id_evenement}})]"><i class="icon-arrow-right icon-white"></i> <:larut:inscription:></a> 
			</div>	
             <//B_evs_enfant>                             
        </BOUCLE_date_resultat>

</B_date_resultat>
<div class="cours_non"><:larut:pas_cours_programmee:></div>
<a class="btn btn-primary" href="[(#GET{url_reservation}|parametre_url{id_evenement,#GET{id_evenement}})]"><i class="icon-arrow-right icon-white"></i> <:larut:inscription:></a>
<//B_date_resultat>
